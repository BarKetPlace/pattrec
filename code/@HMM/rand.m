function [X,S]=rand(h,nSamples)%[X,S]=rand(h,nSamples);generates a random sequence of data%from a given Hidden Markov Model.%%Input:%h=         HMM object%nSamples=  maximum no of output samples (scalars or column vectors)%%Result:%X= matrix or row vector with output data samples%S= row vector with corresponding integer state values%   obtained from the h.StateGen component.%   nS= length(S) == size(X,2)= number of output samples.%   If the StateGen can generate infinite-duration sequences,%       nS == nSamples%   If the StateGen is a finite-duration MarkovChain,%       nS <= nSamples%% %----------------------------------------------------%Code Authors:% Antoine HonorÃ©% Audrey Brouard%----------------------------------------------------nbState = h.StateGen.nStates;nDim = sum( size(h.OutputDistr(1,1).Mean)) - 1;if numel(h)>1    error('Method works only for a single object');end;mc = h.StateGen;S = mc.rand(nSamples);% In case the HMM is a finite-durationS = S(S(:)~=0); % Remove the unused slotsS = S(S(:)<nbState+1); % Remove the last value (exit state)nSamples = size(S,2); % In case of a finite duration, the number of samples is lowerdistrib = h.OutputDistr;for i = 1:size(S,2)    X(1:nDim,i) = distrib(1,S(1,i)).rand(1);endend